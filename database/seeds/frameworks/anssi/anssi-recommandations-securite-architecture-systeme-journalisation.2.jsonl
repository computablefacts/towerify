{"page":1,"tags":["Pr\u00e9requis \u00e0 la mise en place d'un syst\u00e8me de journalisation","Fonction de journalisation","Utiliser des solutions disposant d\u2019une fonction de journalisation native"],"text":"Il est fortement recommand\u00e9 d\u2019utiliser des syst\u00e8mes et des applications disposant nativement d\u2019une fonction de journalisation. Cette fonction de s\u00e9curit\u00e9 doit \u00eatre exig\u00e9e par les responsables de SI en phase amont de tout projet informatique (en \u00e9tant int\u00e9gr\u00e9e aux appels d\u2019offres) et \u00eatre sp\u00e9cifi\u00e9e au plus t\u00f4t par les concepteurs de nouveaux produits informatiques (\u00e9diteurs logiciels, industriels...)."}
{"page":1,"tags":["Pr\u00e9requis \u00e0 la mise en place d'un syst\u00e8me de journalisation","Fonction de journalisation","Activer la journalisation sur un nombre important d\u2019\u00e9quipements du SI"],"text":"La journalisation doit \u00eatre activ\u00e9e et param\u00e9tr\u00e9e sur un large nombre d\u2019\u00e9quipements du SI, en commen\u00e7ant par ceux qui composent les passerelles Internet s\u00e9curis\u00e9es [11] et par ceux qui supportent les valeurs m\u00e9tiers [15] les plus importantes ou qui disposent d\u2019un chemin de contr\u00f4le permettant d\u2019acc\u00e9der \u00e0 ces donn\u00e9es (postes d\u2019administration, serveurs de mise \u00e0 jour, serveurs d\u2019annuaire, hyperviseurs, serveurs de sauvegarde...)."}
{"page":1,"tags":["Pr\u00e9requis \u00e0 la mise en place d'un syst\u00e8me de journalisation","Horodatage des \u00e9v\u00e8nements","Horodater les \u00e9v\u00e8nements"],"text":"L\u2019horodatage doit \u00eatre activ\u00e9 pour l\u2019ensemble des \u00e9v\u00e8nements afin de permettre une meilleure exploitation des journaux."}
{"page":1,"tags":["Pr\u00e9requis \u00e0 la mise en place d'un syst\u00e8me de journalisation","Horodatage des \u00e9v\u00e8nements","Homog\u00e9n\u00e9iser les param\u00e8tres d\u2019horodatage"],"text":"Une attention particuli\u00e8re doit \u00eatre accord\u00e9e \u00e0 l\u2019homog\u00e9n\u00e9it\u00e9 de la configuration des param\u00e8tres d\u2019horodatage (fuseau horaire de r\u00e9f\u00e9rence, pr\u00e9cision de la date...) faute de quoi l\u2019agencement de \u00e9v\u00e8nements dans les journaux pourrait ne pas refl\u00e9ter le d\u00e9roulement chronologique r\u00e9el des faits ayant conduit \u00e0 l\u2019enregistrement de ces \u00e9v\u00e8nements. Une synchronisation des horloges avec une pr\u00e9cision minimale \u00e0 la seconde est recommand\u00e9e."}
{"page":1,"tags":["Pr\u00e9requis \u00e0 la mise en place d'un syst\u00e8me de journalisation","Synchronisation des horloges","Synchroniser les horloges des \u00e9quipements sur des sources de temps coh\u00e9rentes entre elles"],"text":"Les horloges des \u00e9quipements doivent \u00eatre synchronis\u00e9es sur plusieurs sources de temps internes coh\u00e9rentes entre elles. Ces derni\u00e8res peuvent elles-m\u00eames \u00eatre synchronis\u00e9es sur plusieurs sources de temps externes fiables, sauf dans le cas particulier de r\u00e9seaux physiquement isol\u00e9s. Si NTP est utilis\u00e9, il est recommand\u00e9 d\u2019utiliser la m\u00eame version du protocole sur l\u2019ensemble du SI et d\u2019en assurer le maintien en condition de s\u00e9curit\u00e9."}
{"page":1,"tags":["Pr\u00e9requis \u00e0 la mise en place d'un syst\u00e8me de journalisation","Configuration des politiques de journalisation sur les \u00e9quipements","Identifier la granularit\u00e9 de journalisation des \u00e9quipements"],"text":"Pour chaque \u00e9quipement \u00e0 journaliser, il est n\u00e9cessaire de s\u00e9lectionner les types d\u2019\u00e9v\u00e8nements devant \u00eatre stock\u00e9s. Cette politique de journalisation prend notamment en compte les capacit\u00e9s de stockage, de collecte et de traitement des \u00e9v\u00e8nements ainsi que les besoins de s\u00e9curit\u00e9 de l\u2019\u00e9quipement.\u2028\u2028Attention \n\nIl convient d\u2019\u00eatre vigilant quant \u00e0 l\u2019utilisation de modes de configuration de la journalisation qui g\u00e9n\u00e8rent un nombre tr\u00e8s important d\u2019\u00e9v\u00e8nements (mode debug, mode verbose...). Outre que ces modes ne sont g\u00e9n\u00e9ralement pas recommand\u00e9s en fonctionnement nominal, ils peuvent aussi \u00eatre potentiellement r\u00e9v\u00e9lateurs d\u2019informations sensibles (typiquement des secrets)."}
{"page":1,"tags":["Pr\u00e9requis \u00e0 la mise en place d'un syst\u00e8me de journalisation","Configuration des politiques de journalisation sur les \u00e9quipements","Journaliser les empreintes des fichiers potentiellement malveillants"],"text":"Il est recommand\u00e9 de configurer les solutions logicielles de s\u00e9curit\u00e9 d\u00e9ploy\u00e9es sur le SI pour qu\u2019elles journalisent les empreintes des fichiers potentiellement malveillants."}
{"page":1,"tags":["Pr\u00e9requis \u00e0 la mise en place d'un syst\u00e8me de journalisation","Dimensionnement des \u00e9quipements","Espace disque","Estimer l\u2019espace de stockage d\u00e9di\u00e9 aux journaux sur les \u00e9quipements"],"text":"Lors du dimensionnement des \u00e9quipements qui g\u00e9n\u00e8rent des \u00e9v\u00e8nements, il est recommand\u00e9 d\u2019estimer l\u2019espace de stockage local n\u00e9cessaire \u00e0 la conservation des journaux. Cette estimation de l\u2019espace n\u00e9cessaire doit notamment prendre en compte l\u2019\u00e9ventualit\u00e9 d\u2019une indisponibilit\u00e9 temporaire des serveurs de collecte."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Collecte et centralisation des journaux","Centraliser les journaux"],"text":"Les journaux de l\u2019ensemble des \u00e9quipements du SI doivent \u00eatre collect\u00e9s puis transf\u00e9r\u00e9s sur un ou plusieurs serveurs centraux d\u00e9di\u00e9s."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Collecte et centralisation des journaux","Exporter les journaux vers un autre \u00e9quipement"],"text":"\u00c0 d\u00e9faut de mettre en \u0153uvre la centralisation des journaux, il est recommand\u00e9 d\u2019exporter les journaux g\u00e9n\u00e9r\u00e9s par un \u00e9quipement vers un autre \u00e9quipement."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Collecte et centralisation des journaux","Construire un service r\u00e9silient de collecte des journaux"],"text":"Si le parc d\u2019\u00e9quipements qui g\u00e9n\u00e8re des journaux est important, le syst\u00e8me de journalisation doit \u00eatre redond\u00e9 afin d\u2019accro\u00eetre la disponibilit\u00e9 du service de collecte de journaux."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Collecte et centralisation des journaux","Hi\u00e9rarchiser les serveurs constituant le syst\u00e8me de journalisation"],"text":"Si la taille ou la typologie du SI le n\u00e9cessite, une approche hi\u00e9rarchique pour l\u2019organisation des serveurs de collecte, associant serveurs de collecte interm\u00e9diaires et centraux, doit \u00eatre retenue."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Supervision de la cha\u00eene de collecte des \u00e9v\u00e8nements de s\u00e9curit\u00e9","Contr\u00f4ler r\u00e9guli\u00e8rement la couverture de la cha\u00eene de collecte des \u00e9v\u00e8nements"],"text":"Il est recommand\u00e9 de v\u00e9rifier r\u00e9guli\u00e8rement que tous les syst\u00e8mes du SI sont bien journalis\u00e9s (sauf exceptions d\u00fbment identifi\u00e9es) et transf\u00e8rent leurs \u00e9v\u00e8nements \u00e0 des serveurs de collecte des journaux. Le bon fonctionnement de ces serveurs de collecte (interm\u00e9diaires et centraux) doit \u00e9galement \u00eatre v\u00e9rifi\u00e9 en continu (supervision op\u00e9rationnelle et supervision de s\u00e9curit\u00e9)."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","Pr\u00e9traitement des journaux","Conserver les journaux dans leur format natif avant leur transfert"],"text":"Il est recommand\u00e9 de ne pas effectuer de traitement sur les journaux avant leur transfert vers les serveurs centraux. \n\n\u2028Attention \n\nUne attention particuli\u00e8re doit \u00eatre accord\u00e9e au sous-syst\u00e8me de journalisation natif d\u2019un \u00e9quipement quand ce sous-syst\u00e8me ne stocke pas, dans un \u00e9v\u00e8nement, un intitul\u00e9 textuel explicite mais un code qui sera utilis\u00e9, \u00e0 la r\u00e9ception, pour reconstituer un contenu signifiant pour l\u2019administrateur. Dans ce cas, il convient de veiller \u00e0 ce que les serveurs de journalisation centraux auront la capacit\u00e9 \u00e0 recouvrer l\u2019information pertinente par une analyse de ces codes ou, en alternative, de remplacer ce sous-syst\u00e8me de journalisation natif par un sous-syst\u00e8me tiers qui ne met pas en \u0153uvre cette couche d\u2019abstraction."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","Transfert en temps diff\u00e9r\u00e9 ou en \u00ab temps r\u00e9el \u00bb","Privil\u00e9gier un transfert des journaux en \u00ab temps r\u00e9el \u00bb"],"text":"Chaque fois que le contexte le permet, le transfert en \u00ab temps r\u00e9el \u00bb des journaux vers les serveurs de collecte doit \u00eatre privil\u00e9gi\u00e9."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","Transfert en temps diff\u00e9r\u00e9 ou en \u00ab temps r\u00e9el \u00bb","Adopter un transfert des journaux en temps diff\u00e9r\u00e9"],"text":"\u00c0 d\u00e9faut de pouvoir transf\u00e9rer les journaux en \u00ab temps r\u00e9el \u00bb, il est recommand\u00e9 d\u2019automatiser leur transfert vers les serveurs de collecte au plus tard quelques heures apr\u00e8s leur g\u00e9n\u00e9ration."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","Transfert en mode pull ou en mode push","Faire une analyse de risque pour d\u00e9terminer le mode de transfert des journaux"],"text":"Le choix du mode de transfert des journaux (mode pull ou mode push) doit \u00eatre d\u00e9termin\u00e9 au cas par cas apr\u00e8s une analyse de risque prenant en comptes le niveau de sensibilit\u00e9 du serveur collect\u00e9 et du collecteur, ainsi que la surface d\u2019attaque induite par la solution technique retenue pour ce transfert."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","Fiabilisation du transfert des journaux","Utiliser des protocoles fiables pour le transfert des journaux"],"text":"Il est recommand\u00e9 d\u2019utiliser des protocoles d\u2019envoi de journaux reposant sur TCP pour fiabiliser le transfert de donn\u00e9es entre les machines \u00e9mettrices et les serveurs. \n\nCependant, l\u2019usage du protocole TCP ne suffit pas \u00e0 lui seul \u00e0 garantir l\u2019absence de perte de donn\u00e9es. D\u2019autres m\u00e9canismes pr\u00e9sents au niveau applicatif permettent d\u2019am\u00e9liorer encore la fiabilit\u00e9 du transfert en ajoutant des fonctionnalit\u00e9s de cache et d\u2019acquittement plus efficaces."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","S\u00e9curisation du transfert des journaux","Utiliser des protocoles s\u00e9curis\u00e9s pour le transfert des journaux"],"text":"Il est recommand\u00e9 d\u2019assurer la confidentialit\u00e9 et l\u2019int\u00e9grit\u00e9 des journaux transf\u00e9r\u00e9s, ainsi que l\u2019authentification des serveurs de collecte, \u00e0 l\u2019aide de protocoles qui s\u2019appuient sur des m\u00e9canismes cryptographiques robustes, en particulier lorsque les donn\u00e9es transitent sur des r\u00e9seaux non ma\u00eetris\u00e9s. \n\n\u2028Attention \n\nSi les protocoles s\u00e9curis\u00e9s mettent en \u0153uvre des certificats num\u00e9riques, une attention particuli\u00e8re doit \u00eatre accord\u00e9e \u00e0 la gestion de leur cycle de vie (expiration, r\u00e9vocation ...), pour ne pas risquer de porter atteinte \u00e0 la disponibilit\u00e9 du service de journalisation."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","Bande passante","Ma\u00eetriser le flux r\u00e9seau consomm\u00e9 par les transferts de journaux"],"text":"Il est recommand\u00e9 de limiter la consommation de bande passante des flux r\u00e9seau utilis\u00e9e pour transf\u00e9rer les journaux d\u2019\u00e9v\u00e8nements. Si la limitation de bande passante ou la priorisation des flux n\u2019est pas possible, il est recommand\u00e9 de superviser ces flux."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","S\u00e9curisation des serveurs de collecte","Durcir et maintenir \u00e0 jour les serveurs de collecte"],"text":"Les serveurs de collecte doivent \u00eatre durcis et une attention particuli\u00e8re doit \u00eatre accord\u00e9e \u00e0 leur maintien en condition de s\u00e9curit\u00e9."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","S\u00e9curisation des serveurs de collecte","Cloisonner les serveurs de collecte au sein d\u2019un SI d\u2019administration"],"text":"Lorsque le besoin de s\u00e9curit\u00e9 pour le traitement des journaux est important, celui-ci doit se faire dans une zone d\u00e9di\u00e9e du SI d\u2019administration; les serveurs de collecte interm\u00e9diaires et centraux doivent \u00eatre h\u00e9berg\u00e9s sur ce SI d\u2019administration."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Protection des donn\u00e9es \u00e9chang\u00e9es","S\u00e9curisation des serveurs de collecte","Cloisonner les serveurs de collecte dans une zone d\u00e9di\u00e9e"],"text":"S\u2019il n\u2019existe pas de SI d\u2019administration dans l\u2019architecture pour accueillir les serveurs de collecte interm\u00e9diaires et centraux, ils doivent \u00eatre plac\u00e9s dans une zone interne d\u00e9di\u00e9e, non expos\u00e9e directement \u00e0 des r\u00e9seaux qui ne sont pas de confiance (p. ex. Internet)."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Partition d\u00e9di\u00e9e","D\u00e9dier une partition disque au stockage des journaux"],"text":"Une partition disque doit \u00eatre d\u00e9di\u00e9e au stockage des journaux d\u2019\u00e9v\u00e8nements sur les \u00e9quipements qui les g\u00e9n\u00e8rent ou qui les collectent. Cette recommandation n\u2019est r\u00e9ellement pertinente que dans le cas o\u00f9 les fichiers de journalisation n\u2019ont pas des tailles maximales fix\u00e9es. \n\n\u2028Attention \n\nDes journaux pourraient \u00eatre perdus si la partition d\u00e9di\u00e9e venait \u00e0 \u00eatre satur\u00e9e \u00e0 son tour, ou, dans le cas o\u00f9 les fichiers de journalisation ont une taille maximale fix\u00e9e, si ces fichiers venaient \u00e0 \u00eatre satur\u00e9s d\u2019\u00e9v\u00e8nements. Pour ces raisons, l\u2019acc\u00e8s en \u00e9criture \u00e0 la partition d\u00e9di\u00e9e doit \u00eatre r\u00e9serv\u00e9 aux seuls processus d\u00fbment autoris\u00e9s par l\u2019administrateur de l\u2019\u00e9quipement et une politique ad\u00e9quate de rotation et de supervision des journaux doit \u00eatre mise en \u0153uvre en compl\u00e9ment de cette mesure (se reporter aux sections 3.4.4 et 3.4.2)."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Supervision de l'espace disque","Superviser l\u2019espace disque de stockage des journaux"],"text":"L\u2019espace disque des \u00e9quipements qui g\u00e9n\u00e8rent et stockent les journaux doit \u00eatre supervis\u00e9."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Arborescence de fichiers ou base de donn\u00e9es index\u00e9e","Classer les journaux suivant leur th\u00e9matique"],"text":"Il est recommand\u00e9 de stocker les journaux d\u2019\u00e9v\u00e8nements dans une arborescence de r\u00e9pertoires class\u00e9s par th\u00e9matiques."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Arborescence de fichiers ou base de donn\u00e9es index\u00e9e","Privil\u00e9gier le stockage des journaux dans une base de donn\u00e9es index\u00e9e"],"text":"Quand cela est possible, il est recommand\u00e9 de privil\u00e9gier des solutions permettant le stockage des journaux dans une base de donn\u00e9es index\u00e9e et la conservation d\u2019une copie des journaux non transform\u00e9s."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Rotation des journaux","D\u00e9finir et appliquer une politique de rotation des journaux"],"text":"Une politique de rotation des journaux d\u2019\u00e9v\u00e8nements doit \u00eatre formalis\u00e9e et mise en \u0153uvre sur l\u2019ensemble des \u00e9quipements du syst\u00e8me de journalisation."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Dur\u00e9e de r\u00e9tention des journaux","Configurer des dur\u00e9es de r\u00e9tention des journaux conformes \u00e0 la r\u00e9glementation"],"text":"La dur\u00e9e de conservation des fichiers de journaux \u00e9tant soumise \u00e0 des exigences r\u00e9glementaires, il convient d\u2019en prendre connaissance pour d\u00e9finir les moyens techniques n\u00e9cessaire \u00e0 la suppression des journaux. Dans la mesure du possible, il est recommand\u00e9 d\u2019automatiser cette suppression."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Protection des journaux","Restreindre au strict besoin op\u00e9rationnel les droits d\u2019acc\u00e8s en \u00e9criture aux journaux"],"text":"L\u2019acc\u00e8s \u00e0 chaque journal doit \u00eatre limit\u00e9 en \u00e9criture (pour l\u2019\u00e9criture de nouveaux \u00e9v\u00e8nements) aux seuls comptes utilisateurs (compte de personne ou compte de service) dont le r\u00f4le ou la fonction le justifie."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Protection des journaux","Restreindre au strict besoin op\u00e9rationnel les droits de suppression des journaux"],"text":"Si le syst\u00e8me d\u2019exploitation ou l\u2019application le permet, il est recommand\u00e9 que seuls les comptes utilisateurs d\u00e9di\u00e9s \u00e0 l\u2019administration privil\u00e9gi\u00e9e des \u00e9quipements disposent des droits de suppression des journaux."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Stockage","Protection des journaux","Restreindre au strict besoin op\u00e9rationnel les droits d\u2019acc\u00e8s en lecture aux journaux"],"text":"L\u2019acc\u00e8s \u00e0 chaque journal doit \u00eatre limit\u00e9 en lecture (pour la consultation des \u00e9v\u00e8nements journalis\u00e9s) aux seuls comptes utilisateurs (compte de personne ou compte de service) dont le r\u00f4le ou la fonction le justifie."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Externalisation","Journalisation en cas d'externalisation du SI","\u00c9tudier l\u2019alternative d\u2019un ou plusieurs syst\u00e8mes de journalisation en cas d\u2019externalisation"],"text":"Si tout ou partie du SI de l\u2019entit\u00e9 est externalis\u00e9, le choix de mettre en \u0153uvre un ou plusieurs syst\u00e8mes de journalisation doit \u00eatre \u00e9tudi\u00e9 suivant des crit\u00e8res fonctionnels et de s\u00e9curit\u00e9."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Externalisation","Journalisation en cas d'externalisation du SI","R\u00e9cup\u00e9rer les journaux relatifs aux interconnexions en cas d\u2019externalisation"],"text":"En cas d\u2019externalisation d\u2019un sous-syt\u00e8me du SI de l\u2019entit\u00e9 et de la mise en \u0153uvre d\u2019une interconnexion, il est recommand\u00e9 de r\u00e9cup\u00e9rer, de pr\u00e9f\u00e9rence sur le syst\u00e8me de journalisation interne de l\u2019entit\u00e9, tous les journaux li\u00e9s \u00e0 cette interconnexion (p. ex. concentrateurs VPN, serveurs de f\u00e9d\u00e9ration d\u2019identit\u00e9)."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Externalisation","Externalisation du stockage des journaux et de la d\u00e9tection des incidents de s\u00e9curit\u00e9","Recourir \u00e0 un PDIS en cas d\u2019externalisation du stockage ou de la corr\u00e9lation de journaux"],"text":"En cas d\u2019externalisation du stockage ou de la corr\u00e9lation de journaux, il est recommand\u00e9 d\u2019avoir recours \u00e0 un prestataire de d\u00e9tection des incidents de s\u00e9curit\u00e9 qualifi\u00e9 par l\u2019ANSSI."}
{"page":1,"tags":["Architecture et conception d'un syst\u00e8me de journalisation","Cas particulier des postes nomades","Collecter les journaux des postes en situation de nomadisme"],"text":"Il est recommand\u00e9 de maintenir la collecte des journaux des postes en situation de nomadisme gr\u00e2ce \u00e0 un tunnel VPN."}
