[
  {
    "name": "active_connections",
    "description": "Network connections from system processes.",
    "query": "select * from process_open_sockets LEFT JOIN processes ON process_open_sockets.pid = processes.pid WHERE process_open_sockets.remote_port != 0 AND processes.name != '' AND processes.name != 'nginx' AND processes.name != 'chronyd' AND processes.name != 'sendmail' AND processes.name != 'go-cve-dictiona' AND process_open_sockets.remote_address NOT LIKE '%172.%' AND process_open_sockets.remote_address NOT LIKE '%192.168.%' AND process_open_sockets.remote_address NOT IN('127.0.0.1', '10.0.2.2', '172.24.0.1', '172.23.0.1', '172.22.0.1', '172.21.0.1', '172.21.0.2', '172.21.0.3', '10.0.2.3', '127.0.0.53') AND process_open_sockets.path NOT LIKE '%usr/lib/firefox-esr/firefox-esr%' AND process_open_sockets.path NOT LIKE '%/usr/local/bin/node%' AND process_open_sockets.cwd NOT LIKE '%/opt/impulse/managerd%' AND process_open_sockets.cwd NOT LIKE '%usr/local/bin/celery%';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "network",
    "enabled": 0,
    "attck": "T1021,T1210",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "apt_sources",
    "description": "Retrieves all the APT sources to install packages from in the target Linux system.",
    "query": "SELECT * FROM apt_sources;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 0,
    "attck": "T1222",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "authorized_keys",
    "description": "Retrieves the list of authorized_keys for each user.",
    "query": "SELECT * FROM users CROSS JOIN authorized_keys USING (uid);",
    "version": "1.4.5",
    "interval": 600,
    "snapshot": 0,
    "platform": "posix",
    "category": "backdoor",
    "enabled": 1,
    "attck": null,
    "is_ioc": 1,
    "score": 50,
    "comments": "A new authorized_keys (used to provide access through SSH to administrate the machine) was added. If it was not done one purpose it might indicate that an attacker added the key as a backdoor."
  },
  {
    "name": "bash_exfiltration",
    "description": "Bash exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'bash' AND cmdline LIKE '%POST%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 20,
    "comments": "Someone sent data through a POST request via the command line."
  },
  {
    "name": "behavioral_reverse_shell",
    "description": "Find shell processes that have open sockets",
    "query": "SELECT DISTINCT(processes.pid), processes.parent, processes.name, processes.path, processes.cmdline, processes.cwd, processes.root, processes.uid, processes.gid, processes.start_time, process_open_sockets.remote_address, process_open_sockets.remote_port, (SELECT cmdline FROM processes AS parent_cmdline WHERE pid=processes.parent) AS parent_cmdline FROM processes JOIN process_open_sockets USING (pid) LEFT OUTER JOIN process_open_files ON processes.pid = process_open_files.pid WHERE (name='sh' OR name='bash') AND remote_address NOT IN ('0.0.0.0', '::', '') AND remote_address NOT LIKE '10.%' AND remote_address NOT LIKE '192.168.%';",
    "version": "1.4.5",
    "interval": 60,
    "snapshot": 0,
    "platform": "posix",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1505/003",
    "is_ioc": 1,
    "score": 60,
    "comments": "Shell (sh or bach) was used to connect to a remote endpoint, there is a high probability that this is a reverse shell used by attacker to send commands on compromised server."
  },
  {
    "name": "busybox_server",
    "description": "Busybox process.",
    "query": "SELECT * FROM processes WHERE cmdline LIKE '%busybox httpd%' ",
    "version": "1.4.5",
    "interval": 60,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 60,
    "comments": "Busybox webserver is active on the machine, it is a behaviour usually linked to attackers wanting to exfiltrate data from the machine."
  },
  {
    "name": "cancel_exfiltration",
    "description": "Cancel exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'cancel' AND cmdline LIKE '%-h %' ",
    "version": "1.4.5",
    "interval": 60,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 60,
    "comments": "Cancel command line tool is active on your machine. This tool is often use by attackers to exfiltrate data."
  },
  {
    "name": "chocolatey_packages",
    "description": "Retrieves all the installed Chocolatey packages in the target Windows system.",
    "query": "SELECT * FROM chocolatey_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "windows",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1072",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "crontab",
    "description": "Retrieves all the jobs scheduled in crontab in the target system. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM crontab;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "backdoor",
    "enabled": 1,
    "attck": "T1053/003",
    "is_ioc": 1,
    "score": 50,
    "comments": "A new job has been added in crontab, this might indicate that an attacker has added some tasks to be run on a given schedule."
  },
  {
    "name": "curl_exfiltration",
    "description": "Curl exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'curl' AND cmdline LIKE '%POST%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 30,
    "comments": "The curl command line tool has been used to POST data to a server, this might indicate data exfiltration."
  },
  {
    "name": "curl_file_download",
    "description": "Curl file download.",
    "query": "SELECT * FROM processes WHERE name = 'curl' AND cmdline LIKE '%--output%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "file_download",
    "enabled": 1,
    "attck": "T1105",
    "is_ioc": 1,
    "score": 10,
    "comments": "Curl has been used to download something on the machine, this tool is often used by attackers to download there tools on the machine"
  },
  {
    "name": "deb_packages",
    "description": "Retrieves all the installed DEB packages in the target Linux system.",
    "query": "SELECT * FROM deb_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1072",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "dns_exfiltration",
    "description": "Possible DNS exfiltration",
    "query": "SELECT * FROM processes WHERE name = 'dig' AND cmdline LIKE '%@%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 10,
    "comments": "Dig was used on the machine, this is not often used on servers but sometimes attacker use it to exfiltrate data via DNS."
  },
  {
    "name": "dsniff_installed",
    "description": "dsniff was installed",
    "query": "SELECT * FROM deb_packages where name = 'dsniff';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 1,
    "score": 10,
    "comments": "Dsnif was installed, legitimate use of this tool is quite rare but it is often used by attackers to sniff networks."
  },
  {
    "name": "etc_hosts",
    "description": "Retrieves all the entries in the target system /etc/hosts file. Helps you identify network communications that are being redirected.",
    "query": "SELECT * FROM etc_hosts;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "network",
    "enabled": 1,
    "attck": "T1136",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "etc_services",
    "description": "Retrieves the list of running Etc services. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM etc_services;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "processes",
    "enabled": 1,
    "attck": "T1543/002",
    "is_ioc": 1,
    "score": 10,
    "comments": "A new service has been added, this might indicate that an attacker has added it to provide persistence."
  },
  {
    "name": "ftp_process",
    "description": "FTP process",
    "query": "SELECT * FROM processes WHERE name = 'ftp'",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "T1105,TA0010",
    "is_ioc": 1,
    "score": 20,
    "comments": "Ftp process was detected, this might indicate data exfiltration."
  },
  {
    "name": "groups",
    "description": "Retrieves the list of groups.",
    "query": "SELECT * FROM groups;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "users_and_authentication",
    "enabled": 1,
    "attck": "T1136,T1078",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "hidden_directories",
    "description": "Lists hidden directories in relevant path.",
    "query": "SELECT fi.path, fi.filename, datetime(fi.btime, 'unixepoch', 'UTC') AS btime, datetime(fi.atime, 'unixepoch', 'UTC') AS atime, datetime(fi.ctime, 'unixepoch', 'UTC') AS ctime, datetime(fi.mtime, 'unixepoch', 'UTC') AS mtime FROM file fi WHERE fi.filename NOT IN ('.', '..') AND ((fi.path LIKE '/home/%%/.%') OR (fi.path LIKE '/root/.%')) AND type='directory';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "backdoor",
    "enabled": 1,
    "attck": null,
    "is_ioc": 1,
    "score": 20,
    "comments": "New hidden directory discovered, this might indicate that an attacker is trying to hide some tools."
  },
  {
    "name": "hidden_files",
    "description": "Lists hidden files in relevant path.",
    "query": "SELECT hash.sha1, fi.path, fi.filename, datetime(fi.btime, 'unixepoch', 'UTC') AS btime, datetime(fi.atime, 'unixepoch', 'UTC') AS atime, datetime(fi.ctime, 'unixepoch', 'UTC') AS ctime, datetime(fi.mtime, 'unixepoch', 'UTC') AS mtime FROM hash JOIN file fi USING (path) WHERE ((fi.path LIKE '/home/%%/.%') OR (fi.path LIKE '/root/.%')) AND type='regular';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "backdoor",
    "enabled": 1,
    "attck": null,
    "is_ioc": 1,
    "score": 20,
    "comments": "New hidden file discovered, this might indicate that an attacker is trying to hide some tools."
  },
  {
    "name": "homebrew_packages",
    "description": "Retrieves the list of brew packages installed in the target OSX system.",
    "query": "SELECT * FROM homebrew_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "darwin",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "hping3_installed",
    "description": "hping3 was installed",
    "query": "SELECT * FROM deb_packages where name = 'hping3';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 1,
    "score": 30,
    "comments": "Hping3 was installed on the machine, this tool is often used by attackers to craft packet, legitimate use is quite rare."
  },
  {
    "name": "interface_addresses",
    "description": "Retrieves the list of network interfaces.",
    "query": "SELECT * FROM interface_addresses;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "network",
    "enabled": 1,
    "attck": "T1040",
    "is_ioc": 0,
    "score": 0,
    "comments": "New network interface deployed on machine"
  },
  {
    "name": "ip_forwarding",
    "description": "Retrieves the current status of IP/IPv6 forwarding. Helps you identify if a machine is being used as relay.",
    "query": "SELECT * FROM system_controls WHERE oid = '4.30.41.1' UNION SELECT * FROM system_controls WHERE oid = '4.2.0.1';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "This machine now relays data between two network interfaces."
  },
  {
    "name": "kernel_modules",
    "description": "Retrieves all the information for the current kernel modules in the target Linux system. Helps you identify malware that has a kernel module component.",
    "query": "SELECT * FROM kernel_modules;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1547/006",
    "is_ioc": 1,
    "score": 30,
    "comments": "New kernel module detected, if this is not linked to an update or a voluntary installation of a service/tool that needs a kernel module this might indicate a backdoor installation."
  },
  {
    "name": "kernel_modules_and_extensions",
    "description": "Detect loading, unloading, and manipulating modules on Linux systems.",
    "query": "SELECT usr.username, sht.command, sht.history_file FROM shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid FROM users) AND (sht.command LIKE '%modprobe%' OR sht.command LIKE '%insmod%' OR sht.command  LIKE '%lsmod%' OR sht.command  LIKE '%rmmod%' OR sht.command LIKE '%modinfo%' OR sht.command LIKE '%linux-headers-$%'OR sht.command LIKE '%kernel-devel-$%');",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": null,
    "is_ioc": 1,
    "score": 40,
    "comments": "Manual module manipulation has been detected, it is rare that legitimate user manipulate modules from the command line, this might indicate that an attacker is trying to manipulate (deactivate, load, etc.) kernel modules. This is usually to add backdoor or remove potential system in place to limit attackers."
  },
  {
    "name": "last",
    "description": "Retrieves the list of the latest logins with PID, username and timestamp. Useful for intrusion detection and incident response. Verify assumptions of what accounts should be accessing what systems and identify machines accessed during a compromise.",
    "query": "SELECT * FROM last;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "posix",
    "category": "users_and_authentication",
    "enabled": 1,
    "attck": "T1078",
    "is_ioc": 0,
    "score": 10,
    "comments": "A user as logged to the machine via SSH, if this access is not legitimate it might indicate compromission."
  },
  {
    "name": "ld_preload_snapshot",
    "description": "Any processes that run with an LD_PRELOAD environment variable.",
    "query": "SELECT process_envs.pid, process_envs.key, process_envs.value, processes.name, processes.path, processes.cmdline, processes.cwd FROM process_envs JOIN processes USING (pid) WHERE KEY = 'LD_PRELOAD';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 1,
    "platform": "linux",
    "category": "processes",
    "enabled": 1,
    "attck": "T1136,T1574/006",
    "is_ioc": 1,
    "score": 60,
    "comments": "A process has run with LD_PRELOAD environment variable, this is often the sign that an attacker is trying to override normal behaviour by compromised version of function loaded via LD_PRELOAD."
  },
  {
    "name": "listening_ports",
    "description": "Retrieves all the listening ports in the target system. Detect if a listening port is not mapped to a known process. Find backdoors.",
    "query": "SELECT * FROM listening_ports;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "network",
    "enabled": 0,
    "attck": "T1029,T1011,T1041,T1048,T1020,T1071,T1219,T1505/003",
    "is_ioc": 1,
    "score": 10,
    "comments": "A new open ports has been detected on the machine, needs further qualification."
  },
  {
    "name": "logged_in_users",
    "description": "Retrieves the list of all the currently logged in users in the target system.",
    "query": "SELECT liu.*, p.name, p.cmdline, p.cwd, p.root FROM logged_in_users liu, processes p WHERE liu.pid = p.pid;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "users_and_authentication",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "logon_sessions",
    "description": "Retrieves the list of the latest logins with PID, username and timestamp. Useful for intrusion detection and incident response. Verify assumptions of what accounts should be accessing what systems and identify machines accessed during a compromise.",
    "query": "SELECT * FROM logon_sessions;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "windows",
    "category": "users_and_authentication",
    "enabled": 0,
    "attck": "T1078",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "npm_packages",
    "description": "Retrieves the list of NPM packages.",
    "query": "SELECT * FROM npm_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "all",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1059/006",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "nbtscan_installed",
    "description": "nbtscan was installed.",
    "query": "SELECT * FROM deb_packages where name = 'nbtscan';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 1,
    "score": 20,
    "comments": "Nbtscan has been installed on the machine, it is often used by attackers to scan networks."
  },
  {
    "name": "netcat_installed",
    "description": "Netcat was installed.",
    "query": "SELECT * FROM deb_packages where name = 'netcat';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 1,
    "score": 20,
    "comments": "Netcat is installed, it is often used by attacker to create reverse shell (shell access that connect to a remote server) or listen on the network to provide a shell access."
  },
  {
    "name": "netcat_listener",
    "description": "Netcat listener.",
    "query": "SELECT * FROM processes WHERE name IN ('nc', 'netcat', 'ncat') AND (cmdline LIKE '%-l%' or cmdline LIKE '%-e%' or cmdline LIKE '%/bin/%' or cmdline LIKE '%bash%')",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "T1049,TA0010",
    "is_ioc": 1,
    "score": 90,
    "comments": "Netcat is listening or executing commands, this is a really unusual behaviour, there is a high probability of compromise."
  },
  {
    "name": "nmap_installed",
    "description": "Nmap was installed.",
    "query": "SELECT * FROM deb_packages where name = 'nmap';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 1,
    "score": 10,
    "comments": "Nmap was installed on the machine, this tool is often used by attackers to scan network."
  },
  {
    "name": "nmap_process",
    "description": "Nmap process.",
    "query": "SELECT * FROM processes WHERE name = 'nmap'",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "processes",
    "enabled": 1,
    "attck": "T1423,TA0010",
    "is_ioc": 1,
    "score": 30,
    "comments": "Nmap was used on the machine, this tool is often used by attackers to scan network."
  },
  {
    "name": "open_files",
    "description": "Retrieves all the open files per process in the target system. Helps you identify processes accessing sensitive files they shouldn't.",
    "query": "SELECT DISTINCT pid, path FROM process_open_files WHERE path NOT LIKE '/private/var/folders%' AND path NOT LIKE '/System/Library/%' AND path NOT IN ('/dev/null', '/dev/urandom', '/dev/random');",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "open_sockets",
    "description": "Retrieves all the open sockets per process in the target system. Helps you identify malware via connections to known bad IP addresses as well as odd local or remote port bindings.",
    "query": "SELECT DISTINCT pid, family, protocol, local_address, local_port, remote_address, remote_port, path FROM process_open_sockets WHERE path <> '' OR remote_address <> '';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "openssh_server_installed",
    "description": "OpenSSH was installed.",
    "query": "SELECT * FROM deb_packages where name = 'openssh-server';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 0,
    "attck": "T1021/004",
    "is_ioc": 1,
    "score": 20,
    "comments": "High probability of it being legitimate."
  },
  {
    "name": "openssl_exfiltration",
    "description": "OpenSSL exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'openssl' AND cmdline LIKE '%connect%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 60,
    "comments": "Openssl process was launched with the connect argument, there is a high Probability that this is done for exfiltrating data."
  },
  {
    "name": "os_version",
    "description": "Retrieves information from the Operative System where osquery is currently running. Helps you identify out of date operating systems or version drift across your infrastructure.",
    "query": "SELECT * FROM os_version;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "php_server",
    "description": "PHP server.",
    "query": "SELECT * FROM processes WHERE name = 'php' AND cmdline LIKE '%-S 0.0.0.0%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 60,
    "comments": "A php server seems to be launched, there is a high probability that this is done for exfiltrating data."
  },
  {
    "name": "portage_packages",
    "description": "Retrieves all the packages installed with portage from the target Linux system.",
    "query": "SELECT * FROM portage_packages;",
    "version": "2.0.0",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1059/006",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "process_env",
    "description": "Retrieves all the environment variables per process in the target system. Insight into the process data: where was it started from, was it preloaded...",
    "query": "SELECT * FROM process_envs;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "process_listening_port",
    "description": "Returns the listening ports list.",
    "query": "SELECT p.name, p.path, lp.port, lp.address, lp.protocol  FROM listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "process_open_sockets",
    "description": "Returns the network connections from system processes.",
    "query": "SELECT DISTINCT p.name, p.path, pos.remote_address, pos.remote_port FROM process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "processes",
    "description": "Processes running on the host.",
    "query": "SELECT pid, name, path, cmdline FROM processes WHERE name NOT IN ('systemd', 'systemd-network', 'dbus-daemon', 'cron', 'networkd-dispat', 'VBoxService', 'kstrp', 'systemd-resolve', 'pickup', 'osqueryd', 'rsyslogd', 'nginx', 'mysqld', 'sshd', 'sudo', 'su', 'systemd-journal', 'vuls', 'accounts-daemon', 'acpi_thermal_pm', 'snapd', 'osqueryi','bash', 'polkitd', 'Suricata-Main', 'systemctl', 'systemd-tty-ask', 'sendmail', 'procmail', 'sendmail-msp', 'postgres', 'systemd-udevd', 'containerd-shim', 'Isolated Web Co', 'celery', 'docker') AND name NOT LIKE '%loop%' AND name NOT LIKE '%kworker%' AND name NOT LIKE '%scsi%' AND name NOT LIKE '%postgres:%' AND cmdline NOT LIKE '%:6379%' AND name NOT LIKE '%migration%' AND name NOT LIKE '%postgres: postgres%' AND name NOT LIKE '%watchdog%' AND name NOT LIKE '%cpuhp%' AND name NOT LIKE '%cpuhp%' AND name NOT LIKE '%ksoftirqd%' AND name NOT LIKE '%mysql%' AND name NOT LIKE '%kswapd%' AND name NOT LIKE '%postgres%' AND name NOT LIKE '%systemd-udevd%' AND name NOT LIKE '%sendmail%' AND cmdline NOT LIKE '%localhost:5020 --reload wsgi:app%' AND cmdline NOT LIKE '%127.0.0.1:5020%' AND cmdline NOT LIKE '%analytics_run.sh%' AND cmdline NOT LIKE '%PingStatusUpdate.py%' AND cmdline NOT LIKE '%ping_status_update.sh%' AND cmdline NOT LIKE '%full_status_update.sh%' AND cmdline NOT LIKE '%go-cve-dictionary%' AND cmdline NOT LIKE '%impulse/tasks_manager%' AND cmdline NOT LIKE '%FullStatusUpdate.py%' AND cmdline NOT LIKE '%build_status_report.sh%' AND cmdline NOT LIKE '%sendmail%' AND cmdline NOT LIKE '%main.bgtasks.general_tasks worker%' AND cmdline NOT LIKE '%impulse.conf%' AND cmdline NOT LIKE '%host-port 7543%' AND cmdline NOT LIKE '%/etc/init.d/sendmail%' AND cmdline NOT LIKE '%auxiliary_server/venv/bin/gunicorn%' AND cmdline NOT LIKE '%gunicorn_starter.sh%' AND cmdline NOT LIKE '%tasks_manager/cron_tasks/detections.sh%' AND cmdline NOT LIKE '%nids_flow_analysis.sh%' AND cmdline NOT LIKE '%/usr/lib/firefox-esr/firefox-esr%' AND cmdline NOT LIKE '%impulse-bgtasks%' AND cmdline NOT LIKE '%main.celery_app worker%' AND cmdline NOT LIKE '%/impulse/aux_server/aux-venv%' AND cmdline NOT LIKE '%sleep%' AND cmdline NOT LIKE '%0.0.0.0:5020%' AND cmdline NOT LIKE '%usr/bin/suricata-update%';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "processes",
    "enabled": 0,
    "attck": "T1057",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "processor_available_snapshot",
    "description": "Track processor usage.",
    "query": "SELECT printf(ROUND((CAST(SUM(system) AS FLOAT)/(SUM(idle)+SUM(system)+SUM(USER)))*100,2)) AS time_spent_on_system_workloads_pct, printf(ROUND((CAST(SUM(USER) AS FLOAT)/(SUM(idle)+SUM(system)+SUM(USER)))*100,2)) AS time_spent_on_user_workloads_pct, printf(ROUND((CAST(SUM(idle) AS FLOAT)/(SUM(idle)+SUM(system)+SUM(USER)))*100,2)) AS time_spent_idle_pct FROM cpu_time;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 1,
    "platform": "posix",
    "category": "metrics",
    "enabled": 0,
    "attck": "T1496",
    "is_ioc": 0,
    "score": 0,
    "comments": "Not useful"
  },
  {
    "name": "python_packages",
    "description": "Retrieves the list of Python packages.",
    "query": "SELECT * FROM python_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "all",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1059/006",
    "is_ioc": 0,
    "score": 0,
    "comments": "Not useful unless we map this with vulnerable packages"
  },
  {
    "name": "python_server",
    "description": "Python server",
    "query": "SELECT * FROM processes WHERE name = 'python' OR name = 'python3' AND cmdline LIKE '%http.server%' OR cmdline LIKE '%SimpleHTTPServer%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 60,
    "comments": "A python http server is running, there is a high probability that this is done for exfiltrating data."
  },
  {
    "name": "ramdisk",
    "description": "Retrieves all the ramdisk currently mounted in the target system. Helps you identify if an attacker is using temporary, memory storage to avoid touching disk for anti-forensics purposes.",
    "query": "SELECT * FROM block_devices WHERE type = 'Virtual Interface';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Not really useful"
  },
  {
    "name": "registry_hives",
    "description": "Retrieves all of the Windows registry hives.",
    "query": "SELECT * FROM registry;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "windows",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "rpm_packages",
    "description": "Retrieves all the installed RPM packages in the target Linux system.",
    "query": "SELECT * FROM rpm_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1059/006",
    "is_ioc": 0,
    "score": 0,
    "comments": "Not useful unless we map this with vulnerable packages"
  },
  {
    "name": "ruby_server",
    "description": "Ruby server",
    "query": "SELECT * FROM processes WHERE name = 'ruby' AND cmdline LIKE '%httpd%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 60,
    "comments": "A ruby http server is running, there is a high probability that this is done for exfiltrating data."
  },
  {
    "name": "scapy_installed",
    "description": "Scapy was installed",
    "query": "SELECT * FROM deb_packages where name = 'scapy';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 1,
    "score": 30,
    "comments": "Scapy is a tool usually used by attackers to manipulate network traffic. Legitimate use of this tool is quite rare."
  },
  {
    "name": "scheduled_tasks",
    "description": "Retrieves all the scheduled tasks in the target Windows system. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM scheduled_tasks;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "windows",
    "category": "backdoor",
    "enabled": 1,
    "attck": "T1053/003",
    "is_ioc": 1,
    "score": 30,
    "comments": "A new scheduled task ha been detected, thisis often used by hacker to provide persistence."
  },
  {
    "name": "scp_secure_copy",
    "description": "SCP Secure Copy.",
    "query": "SELECT * FROM processes WHERE name = 'scp'",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "T1105,TA0010",
    "is_ioc": 1,
    "score": 20,
    "comments": "Scp use has been detected, this too is used to transfer file securely between machines. It is also often used to exfiltrate data to a remote server."
  },
  {
    "name": "services",
    "description": "Lists all installed Windows services and their relevant data. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM services;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "windows",
    "category": "backdoor",
    "enabled": 1,
    "attck": "T1543/002",
    "is_ioc": 1,
    "score": 30,
    "comments": "A new service has been added, this might indicate that an attacker has added it to provide persistence."
  },
  {
    "name": "shell_check",
    "description": "Returns possible reverse shells on system processes.",
    "query": "SELECT DISTINCT(processes.pid),processes.parent,processes.name,processes.path,processes.cmdline,processes.cwd,processes.root,processes.uid,processes.gid,processes.start_time,process_open_sockets.remote_address,process_open_sockets.remote_port,(SELECT cmdline FROM processes AS parent_cmdline WHERE pid = processes.parent) AS parent_cmdline FROM processes JOIN process_open_sockets USING(pid) LEFT OUTER JOIN process_open_files ON processes.pid = process_open_files.pid WHERE (name = 'sh' OR name = 'bash') AND process_open_files.pid IS NULL;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": null,
    "is_ioc": 1,
    "score": 50,
    "comments": "There is a high probability that a reverse shell has been detected on the machine. This often indicates compromise"
  },
  {
    "name": "shell_history",
    "description": "Retrieves the command history, per user, by parsing the shell history files. Identify actions taken. Useful for compromised hosts.",
    "query": "SELECT * FROM users JOIN shell_history USING (uid);",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "posix",
    "category": "attack_context",
    "enabled": 1,
    "attck": "T1059/004",
    "is_ioc": 0,
    "score": 0,
    "comments": "This is useful to investigate if we detect a high score on another rule to further explain the alert."
  },
  {
    "name": "shell_history_root",
    "description": "Record shell history for root user. Identify actions taken. Useful for compromised hosts.",
    "query": "select * from shell_history;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "posix",
    "category": "users_and_authentication",
    "enabled": 0,
    "attck": "T1059/004",
    "is_ioc": 0,
    "score": 0,
    "comments": "Probably not useful as it has been probably treated in shell_history"
  },
  {
    "name": "socket_events",
    "description": "Socket events collected from the audit framework",
    "query": "SELECT action, auid, family, local_address, local_port, path, pid, remote_address, remote_port, success, time FROM socket_events WHERE success=1 AND path NOT IN ('/usr/bin/hostname') AND remote_address NOT IN ('127.0.0.1','127.0.0.53','', '0000:0000:0000:0000:0000:0000:0000:0001', '::1', '0000:0000:0000:0000:0000:ffff:7f00:0001', 'unknown', '0.0.0.0', '0000:0000:0000:0000:0000:0000:0000:0000', '0') AND remote_address NOT LIKE '%192.168%' AND remote_address NOT LIKE '%127.0.0%' AND remote_address NOT LIKE '%172.19.0.%' AND remote_address NOT LIKE '%10.16%' and remote_port != '0' and remote_port != '5432' and remote_port != '50051' and path NOT LIKE '%/bin/docker-proxy%' and path NOT LIKE '%/bin/postgres%' and path NOT LIKE '%/bin/redis-server%' and path NOT LIKE '%/usr/lib/firefox-esr/firefox-esr%' and path NOT LIKE '%/usr/libexec/sendmail/sendmail%' and path NOT LIKE '%/usr/local/bin/python3.9%';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "posix",
    "category": "network",
    "enabled": 0,
    "attck": "T1021,T1210",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "startup_items",
    "description": "Retrieves the list of systemd services. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM startup_items;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "backdoor",
    "enabled": 1,
    "attck": "T1543/002",
    "is_ioc": 1,
    "score": 20,
    "comments": "A new entry has been added to the list of startup items, this might indicate that an attacker has added it to provide persistence."
  },
  {
    "name": "sudoers",
    "description": "Linux sudoers information.",
    "query": "SELECT * FROM sudoers;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "backdoor",
    "enabled": 1,
    "attck": null,
    "is_ioc": 1,
    "score": 30,
    "comments": "A new user has been added to the list of sudoers, this might indicate a rogue root access from a compromised user"
  },
  {
    "name": "sudoers_sha1",
    "description": "Check any bash reverse shell forwarded to the attacker.",
    "query": "SELECT hash.sha1, fi.path, fi.filename, datetime(fi.btime, 'unixepoch', 'UTC') AS btime, datetime(fi.atime, 'unixepoch', 'UTC') AS atime, datetime(fi.ctime, 'unixepoch', 'UTC') AS ctime, datetime(fi.mtime, 'unixepoch', 'UTC') AS mtime FROM hash JOIN file fi USING (path) WHERE (fi.path LIKE '/etc/sudoers') AND type='regular';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Don't know what to do with this"
  },
  {
    "name": "bash_reverse_shell",
    "description": "Check any bash reverse shell forwarded to the attacker.",
    "query": "SELECT * FROM processes WHERE cmdline LIKE '/bin/bash -i >& /dev/tcp/%';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": null,
    "is_ioc": 1,
    "score": 90,
    "comments": "A back connect shell has been detected."
  },
  {
    "name": "suid_bin",
    "description": "Retrieves all the files in the target system that are setuid enabled. Detect backdoor binaries (attacker may drop a copy of /bin/sh). Find potential elevation points / vulnerabilities in the standard build.",
    "query": "SELECT * FROM suid_bin;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "posix",
    "category": "backdoor",
    "enabled": 1,
    "attck": "T1548,T1548/001",
    "is_ioc": 1,
    "score": 20,
    "comments": "New suid binary discovered. This might be an attacker putting a binary in place for later privilege escalation."
  },
  {
    "name": "system_running_processes",
    "description": "List running processes with CMDLINE not null.",
    "query": "SELECT pr.pid, pr.name, usr.username, pr.path, pr.cmdline FROM processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "systemd",
    "description": "Lists all installed Linux services and their relevant data. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM systemd_units;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "linux",
    "category": "backdoor",
    "enabled": 1,
    "attck": "T1543/002",
    "is_ioc": 1,
    "score": 20,
    "comments": "A new entry has been added to the list of startup items, this might indicate that an attacker has added it to provide persistence."
  },
  {
    "name": "tar_archive_created",
    "description": "Tar Archive Created",
    "query": "SELECT * FROM processes WHERE name = 'tar' AND cmdline LIKE '%-c%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 20,
    "comments": "A tar archive has been created, this might be an attacker preparing data exfiltration."
  },
  {
    "name": "tcpdump_installed",
    "description": "Tcpdump was installed",
    "query": "SELECT * FROM deb_packages where name = 'tcpdump';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1040,T1570",
    "is_ioc": 1,
    "score": 10,
    "comments": "Tcpdump has been installed on the machine, this tool is often used by attackers to sniff network traffic."
  },
  {
    "name": "usb_devices",
    "description": "Retrieves the current list of USB devices in the target system.",
    "query": "SELECT * FROM usb_devices;",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": ""
  },
  {
    "name": "user_ssh_keys",
    "description": "Returns the private keys in the users ~/.ssh directory and whether or not they are encrypted.",
    "query": "SELECT * FROM users CROSS JOIN user_ssh_keys USING (uid);",
    "version": "1.4.5",
    "interval": 300,
    "snapshot": 0,
    "platform": "all",
    "category": "backdoor",
    "enabled": 0,
    "attck": null,
    "is_ioc": 1,
    "score": 30,
    "comments": "New private keys are not often a sign of compromission, the need for encryption might be a rule for hardening though ?"
  },
  {
    "name": "users",
    "description": "Retrieves the list of local system users.",
    "query": "SELECT * FROM users;",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "backdoor",
    "enabled": 1,
    "attck": "T1078,T1136/001",
    "is_ioc": 1,
    "score": 20,
    "comments": "A new user has been added, this might be a backdoor user put by an attacker."
  },
  {
    "name": "wget_exfiltration",
    "description": "Wget exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'wget' AND cmdline NOT LIKE '%--post-file=%' AND cmdline LIKE '%nids-profile-analysis/analyse-flows%' AND cmdline LIKE '%scan-installed-pkgs%' AND cmdline NOT LIKE '%agent-gateway/send/full-status-update%'; ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 0,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0,
    "comments": "TODO: this rules exclude too many things and is not triggered"
  },
  {
    "name": "wget_file_download",
    "description": "Wget file download.",
    "query": "SELECT * FROM processes WHERE name = 'wget' AND cmdline NOT LIKE '%agent-gateway/send/full-status-update%' AND cmdline NOT LIKE '%local-endpoint/%'",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "file_download",
    "enabled": 0,
    "attck": "T1105",
    "is_ioc": 0,
    "score": 0,
    "comments": "TODO: this rules exclude too many things and is not triggered"
  },
  {
    "name": "whois_exfiltration",
    "description": "Whois exfiltration.",
    "query": "SELECT * FROM processes WHERE cmdline LIKE '%whois -h%' ",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 1,
    "score": 20,
    "comments": "Whois might have been used to exfiltrate data."
  },
  {
    "name": "win_packages",
    "description": "Retrieves all the installed programs in the target Windows system.",
    "query": "SELECT * FROM programs;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "windows",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1059/006",
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "win_firewall_rules",
    "description": "",
    "query": "SELECT * FROM windows_firewall_rules;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "windows",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "win_patches",
    "description": "Retrieves all the patches applied. Note: This does not include patches applied via MSI or downloaded from Windows Update (e.g. Service Packs).",
    "query": "SELECT * FROM patches;",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "windows",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "wireless_networks",
    "description": "Retrieves all the remembered wireless network that the target machine has connected to. Helps you identify connections to rogue access points.",
    "query": "SELECT ssid, network_name, security_type, last_connected, captive_portal, possibly_hidden, roaming, roaming_profile FROM wifi_networks;",
    "version": "1.6.0",
    "interval": 300,
    "snapshot": 0,
    "platform": "darwin",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0,
    "comments": "Needs further work on the collected data to be useful"
  },
  {
    "name": "wireshark_installed",
    "description": "Wireshark was installed",
    "query": "SELECT * FROM deb_packages where name = 'wireshark';",
    "version": "1.4.5",
    "interval": 86400,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1040,T1570",
    "is_ioc": 1,
    "score": 20,
    "comments": "Wireshark was installed, legitimate use of this tool is quite rare but it is often used by attackers to sniff wifi networks."
  },
  {
    "name": "cywise_netcat_usage",
    "description": "Detects usage of Netcat (nc, ncat, netcat) in process execution.",
    "query": "SELECT * FROM processes WHERE name IN ('nc', 'netcat', 'ncat');",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1049,T1071/001,T1102/003",
    "is_ioc": 1,
    "score": 70,
    "comments": "Netcat detected running, often used for reverse shells, backdoors, or exfiltration."
  },
  {
    "name": "cywise_ettercap_usage",
    "description": "Detects usage of Ettercap, a tool for network MITM attacks.",
    "query": "SELECT * FROM processes WHERE name = 'ettercap';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "credential_access",
    "enabled": 1,
    "attck": "T1557",
    "is_ioc": 1,
    "score": 70,
    "comments": "Ettercap detected running, commonly used for ARP spoofing and MITM attacks."
  },
  {
    "name": "cywise_nmap_usage",
    "description": "Detects execution of nmap, a network scanning tool.",
    "query": "SELECT * FROM processes WHERE name = 'nmap' AND cmdline NOT LIKE '%--help%' AND cmdline NOT LIKE '%-h%';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "discovery",
    "enabled": 1,
    "attck": "T1046,T1595/002",
    "is_ioc": 1,
    "score": 50,
    "comments": "Nmap detected scanning the network, commonly used for reconnaissance and enumeration."
  },
  {
    "name": "cywise_tcpdump_usage",
    "description": "Detects execution of tcpdump, a network traffic capture tool.",
    "query": "SELECT * FROM processes WHERE name = 'tcpdump' AND cmdline NOT LIKE '%--help%' AND cmdline NOT LIKE '%-h%';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "credential_access",
    "enabled": 1,
    "attck": "T1040",
    "is_ioc": 1,
    "score": 70,
    "comments": "tcpdump detected capturing packets, indicating potential credential theft or network sniffing."
  },
  {
    "name": "cywise_socat_usage",
    "description": "Detects execution of socat, often used as a stealthy alternative to netcat.",
    "query": "SELECT * FROM processes WHERE name = 'socat' AND cmdline NOT LIKE '%--help%' AND cmdline NOT LIKE '%-h%';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1090",
    "is_ioc": 1,
    "score": 65,
    "comments": "Socat detected, commonly used for reverse shells and tunneling."
  },
  {
    "name": "cywise_hping3_usage",
    "description": "Detects execution of hping3, a packet manipulation tool often used for reconnaissance.",
    "query": "SELECT * FROM processes WHERE name = 'hping3';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "discovery",
    "enabled": 1,
    "attck": "T1046",
    "is_ioc": 1,
    "score": 55,
    "comments": "hping3 detected running, often used for network scanning, DoS, or evasion."
  },
  {
    "name": "cywise_nuclei_usage",
    "description": "Detects execution of nuclei, a vulnerability scanner.",
    "query": "SELECT * FROM processes WHERE name = 'nuclei';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "discovery",
    "enabled": 1,
    "attck": "T1595",
    "is_ioc": 1,
    "score": 40,
    "comments": "Nuclei detected scanning for vulnerabilities, indicating potential recon activity."
  },
  {
    "name": "cywise_nbtscan_usage",
    "description": "Detects execution of nbtscan, a NetBIOS scanner often used for reconnaissance.",
    "query": "SELECT * FROM processes WHERE name = 'nbtscan';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "discovery",
    "enabled": 1,
    "attck": "T1595/002",
    "is_ioc": 1,
    "score": 45,
    "comments": "Nbtscan detected, commonly used for SMB enumeration in attacks."
  },
  {
    "name": "cywise_mitmv6_usage",
    "description": "Detects execution of mitmv6, a Man-in-the-Middle attack tool for IPv6.",
    "query": "SELECT * FROM processes WHERE name = 'mitmv6';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "credential_access",
    "enabled": 1,
    "attck": "T1557",
    "is_ioc": 1,
    "score": 70,
    "comments": "mitmv6 detected running, often used for IPv6 MITM attacks."
  },
  {
    "name": "cywise_responder_usage",
    "description": "Detects execution of Responder, an LLMNR/NBNS poisoning tool for credential theft.",
    "query": "SELECT * FROM processes WHERE name = 'responder';",
    "version": "1.4.5",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "credential_access",
    "enabled": 1,
    "attck": "T1557",
    "is_ioc": 1,
    "score": 80,
    "comments": "Responder detected, often used for stealing Windows credentials via LLMNR spoofing."
  },
  {
    "name": "cywise_bash_reverse_shell",
    "description": "Detects Bash reverse shell attempts.",
    "query": "SELECT * FROM processes WHERE name = 'bash' AND (cmdline LIKE '%/dev/tcp/%' OR cmdline LIKE '%/dev/udp/%');",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1059/004",
    "is_ioc": 1,
    "score": 80,
    "comments": "Bash process using /dev/tcp or /dev/udp for network communication, commonly used in reverse shells."
  },
  {
    "name": "cywise_python_reverse_shell",
    "description": "Detects Python reverse shell attempts.",
    "query": "SELECT * FROM processes WHERE name IN ('python', 'python3') AND cmdline LIKE '%socket%';",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1059/006",
    "is_ioc": 1,
    "score": 80,
    "comments": "Python process playing using socket module, indicative of a reverse shell."
  },
  {
    "name": "cywise_php_reverse_shell",
    "description": "Detects PHP reverse shell attempts.",
    "query": "SELECT * FROM processes WHERE name = 'php' AND cmdline LIKE '%fsockopen%';",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1059/005",
    "is_ioc": 1,
    "score": 80,
    "comments": "PHP process using creating a socket, common in PHP reverse shells."
  },
  {
    "name": "cywise_perl_reverse_shell",
    "description": "Detects Perl reverse shell attempts.",
    "query": "SELECT * FROM processes WHERE name = 'perl' AND cmdline LIKE '%Socket%';",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1059/005",
    "is_ioc": 1,
    "score": 80,
    "comments": "Perl process using IO::Socket or Socket module, indicative of a reverse shell."
  },
  {
    "name": "cywise_ruby_reverse_shell",
    "description": "Detects Ruby reverse shell attempts.",
    "query": "SELECT * FROM processes WHERE name = 'ruby' AND (cmdline LIKE '%TCPSocket%' OR cmdline LIKE '%exec%');",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1059/005",
    "is_ioc": 1,
    "score": 80,
    "comments": "Ruby process detected using socket library and executing commands, indicating a potential reverse shell."
  },
  {
    "name": "cywise_golang_reverse_shell",
    "description": "Detects Golang reverse shell attempts.",
    "query": "SELECT * FROM processes WHERE name = 'go' AND (cmdline LIKE '%net.Dial%' OR cmdline LIKE '%exec.Command%' OR cmdline LIKE '%sh%' OR cmdline LIKE '%bash%');",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1059/005",
    "is_ioc": 1,
    "score": 80,
    "comments": "Go binary detected making TCP connections and executing system commands, indicating a potential reverse shell."
  },
  {
    "name": "powershell_reverse_shell",
    "description": "Detects PowerShell reverse shell attempts.",
    "query": "SELECT * FROM processes WHERE name = 'powershell' AND (cmdline LIKE '%New-Object System.Net.Sockets.TCPClient%' OR cmdline LIKE '%System.IO.StreamWriter%' OR cmdline LIKE '%iex%' OR cmdline LIKE '%IEX%');",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "windows",
    "category": "reverse_shell",
    "enabled": 1,
    "attck": "T1059/001",
    "is_ioc": 1,
    "score": 90,
    "comments": "PowerShell process detected making network connections and executing commands, indicating a potential reverse shell."
  },
  {
    "name": "cywise_ngrok_detection",
    "description": "Detects the use of Ngrok for tunneling local services to the internet.",
    "query": "SELECT * FROM processes WHERE name = 'ngrok' OR cmdline LIKE '%ngrok%';",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "tunneling",
    "enabled": 1,
    "attck": "T1090",
    "is_ioc": 1,
    "score": 85,
    "comments": "Ngrok detected running on the system, often used for tunneling local services and can be abused for unauthorized remote access."
  },
  {
    "name": "cywise_frp_detection",
    "description": "Detects the use of Fast Reverse Proxy (FRP) for tunneling local services.",
    "query": "SELECT * FROM processes WHERE name IN ('frpc', 'frps');",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "tunneling",
    "enabled": 1,
    "attck": "T1090",
    "is_ioc": 1,
    "score": 85,
    "comments": "FRP (Fast Reverse Proxy) detected, a common tool used for exposing local services to the internet."
  },
  {
    "name": "cywise_localtunnel_detection",
    "description": "Detects the use of LocalTunnel (lt) for exposing local services.",
    "query": "SELECT * FROM processes WHERE name = 'lt';",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "tunneling",
    "enabled": 1,
    "attck": "T1090",
    "is_ioc": 1,
    "score": 80,
    "comments": "LocalTunnel detected running, a tool used for exposing local services and potentially allowing unauthorized remote access."
  },
  {
    "name": "cywise_reverse_ssh_tunnel",
    "description": "Detects reverse SSH tunnels being established.",
    "query": "SELECT * FROM processes WHERE name = 'ssh' AND cmdline LIKE '%-R%';",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "tunneling",
    "enabled": 1,
    "attck": "T1090",
    "is_ioc": 1,
    "score": 90,
    "comments": "Reverse SSH tunnel detected using `-R` (remote forwarding), often used in unauthorized remote access."
  },
  {
    "name": "cywise_serveo_detection",
    "description": "Detects the use of Serveo, an SSH-based tunneling service.",
    "query": "SELECT * FROM processes WHERE cmdline LIKE '%ssh%' AND cmdline LIKE '%serveo.net%';",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "tunneling",
    "enabled": 1,
    "attck": "T1090",
    "is_ioc": 1,
    "score": 75,
    "comments": "Serveo detected running over SSH, often used to expose local services to the public internet."
  },
  {
    "name": "cywise_dsniff_suite_detection",
    "description": "Detects execution of any tool from the dsniff suite, which includes various network sniffing and MITM attack utilities.",
    "query": "SELECT * FROM processes WHERE name IN ('dsniff', 'arpspoof', 'dnsspoof', 'filesnarf', 'macof', 'mailsnarf', 'msgsnarf', 'sshmitm', 'sshow', 'tcpkill', 'tcpnice', 'urlsnarf', 'webmitm', 'webspy');",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "linux",
    "category": "network_monitoring",
    "enabled": 1,
    "attck": "T1557,T1040",
    "is_ioc": 1,
    "score": 90,
    "comments": "Execution of dsniff suite tools detected, which are often used for network sniffing, ARP/DNS spoofing, MITM, and traffic interception. These tools are frequently used in penetration testing but can also indicate malicious activity."
  },
  {
    "name": "cywise_offensive_tools_execution",
    "description": "Detects execution of offensive security tools like Metasploit, Cobalt Strike, Empire, and BloodHound.",
    "query": "SELECT * FROM processes WHERE name IN ('msfconsole', 'msfvenom', 'cobaltstrike', 'cs', 'powershell-empire', 'empire', 'bloodhound', 'neo4j', 'crackmapexec', 'responder', 'mimikatz', 'nxc');",
    "version": "1.0.0",
    "interval": 30,
    "snapshot": 0,
    "platform": "all",
    "category": "offensive_tool",
    "enabled": 1,
    "attck": "T1059, T1046, T1003",
    "is_ioc": 1,
    "score": 95,
    "comments": "Execution of offensive security tools detected. These tools are commonly used for lateral movement, credential dumping, and privilege escalation."
  }
]