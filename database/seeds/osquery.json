[
  {
    "name": "active_connections",
    "description": "Network connections from system processes.",
    "query": "select * from process_open_sockets LEFT JOIN processes ON process_open_sockets.pid = processes.pid WHERE process_open_sockets.remote_port != 0 AND processes.name != '' AND processes.name != 'nginx' AND processes.name != 'chronyd' AND processes.name != 'sendmail' AND processes.name != 'go-cve-dictiona' AND process_open_sockets.remote_address NOT LIKE '%172.%' AND process_open_sockets.remote_address NOT LIKE '%192.168.%' AND process_open_sockets.remote_address NOT IN('127.0.0.1', '10.0.2.2', '172.24.0.1', '172.23.0.1', '172.22.0.1', '172.21.0.1', '172.21.0.2', '172.21.0.3', '10.0.2.3', '127.0.0.53') AND process_open_sockets.path NOT LIKE '%usr/lib/firefox-esr/firefox-esr%' AND process_open_sockets.path NOT LIKE '%/usr/local/bin/node%' AND process_open_sockets.cwd NOT LIKE '%/opt/impulse/managerd%' AND process_open_sockets.cwd NOT LIKE '%usr/local/bin/celery%';",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "network",
    "enabled": 1,
    "attck": "T1021,T1210",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "ad_config",
    "query": "select * from ad_config;",
    "interval": "86400",
    "platform": "darwin",
    "version": "1.4.5",
    "description": "Retrieves the Active Directory configuration for the target machine, attached to the domain (requires sudo). Helps you debug domain binding / Active Directory issues in your environment.",
    "enabled": 1
  },
  {
    "name": "apt_sources",
    "description": "Retrieves all the APT sources to install packages from in the target Linux system.",
    "query": "SELECT * FROM apt_sources;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1222",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "authorized_keys",
    "description": "Retrieves the list of authorized_keys for each user.",
    "query": "SELECT * FROM users CROSS JOIN authorized_keys USING (uid);",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "bash_exfiltration",
    "description": "Bash exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'bash' AND cmdline LIKE '%POST%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "behavioral_reverse_shell",
    "description": "Find shell processes that have open sockets",
    "query": "SELECT DISTINCT(processes.pid), processes.parent, processes.name, processes.path, processes.cmdline, processes.cwd, processes.root, processes.uid, processes.gid, processes.start_time, process_open_sockets.remote_address, process_open_sockets.remote_port, (SELECT cmdline FROM processes AS parent_cmdline WHERE pid=processes.parent) AS parent_cmdline FROM processes JOIN process_open_sockets USING (pid) LEFT OUTER JOIN process_open_files ON processes.pid = process_open_files.pid WHERE (name='sh' OR name='bash') AND remote_address NOT IN ('0.0.0.0', '::', '') AND remote_address NOT LIKE '10.%' AND remote_address NOT LIKE '192.168.%';",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "processes",
    "enabled": 1,
    "attck": "T1505/003",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "busybox_server",
    "description": "Busybox process.",
    "query": "SELECT * FROM processes WHERE cmdline LIKE '%busybox httpd%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "cancel_exfiltration",
    "description": "Cancel exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'cancel' AND cmdline LIKE '%-h %' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "certificates",
    "description": "Retrieves the list of certificates.",
    "query": "SELECT * FROM certificates;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "crontab",
    "description": "Retrieves all the jobs scheduled in crontab in the target system. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM crontab;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "processes",
    "enabled": 1,
    "attck": "T1053/003",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "curl_exfiltration",
    "description": "Curl exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'curl' AND cmdline LIKE '%POST%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "curl_file_download",
    "description": "Curl file download.",
    "query": "SELECT * FROM processes WHERE name = 'curl' AND cmdline LIKE '%--output%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "file_download",
    "enabled": 1,
    "attck": "T1105",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "deb_packages",
    "description": "Retrieves all the installed DEB packages in the target Linux system.",
    "query": "SELECT * FROM deb_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1072",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "disk_available_snapshot",
    "description": "Track disk usage.",
    "query": "SELECT printf('%.2f',((blocks - blocks_available * 1.0) * blocks_size)/1073741824) AS used_space_gb, printf('%.2f',(1.0 * blocks_available * blocks_size / 1073741824)) AS space_left_gb, printf('%.2f',(1.0 * blocks * blocks_size / 1073741824)) AS total_space_gb, printf('%.2f',(((blocks - blocks_available * 1.0) * blocks_size)/1073741824)/(1.0 * blocks * blocks_size / 1073741824)) * 100 AS '%_used', printf('%.2f',(1.0 * blocks_available * blocks_size / 1073741824)/(1.0 * blocks * blocks_size / 1073741824)) * 100 AS '%_available' FROM mounts WHERE path = '/';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 1,
    "platform": "posix",
    "category": "metrics",
    "enabled": 0,
    "attck": "T1496",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "disk_encryption",
    "description": "Retrieves the current disk encryption status for the target system. Helps you identify a system potentially vulnerable to disk cloning.",
    "query": "SELECT * FROM disk_encryption;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "dns_exfiltration",
    "description": "Possible DNS exfiltration",
    "query": "SELECT * FROM processes WHERE name = 'dig' AND cmdline LIKE '%@%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "dns_resolvers",
    "description": "Retrieves the list of DNS resolvers.",
    "query": "SELECT * FROM dns_resolvers;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "network",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "dsniff_installed",
    "description": "dsniff was installed",
    "query": "SELECT * FROM deb_packages where name = 'dsniff';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "etc_hosts",
    "description": "Retrieves all the entries in the target system /etc/hosts file. Helps you identify network communications that are being redirected.",
    "query": "SELECT * FROM etc_hosts;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "network",
    "enabled": 1,
    "attck": "T1136",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "etc_services",
    "description": "Retrieves the list of running Etc services. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM etc_services;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "processes",
    "enabled": 1,
    "attck": "T1543/002",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "file_events",
    "description": "",
    "query": "SELECT * FROM file_events where target_path NOT LIKE '%.swp%' and target_path NOT LIKE '%.swx%' and target_path NOT LIKE '%~%' and target_path NOT LIKE '%nshadow%' and target_path NOT LIKE '%shadow%' and target_path NOT LIKE '%subgid%' and target_path NOT LIKE '%subuid%' and target_path NOT LIKE '%gshadow%' and target_path NOT LIKE '%.lock%' and target_path NOT LIKE '%+%' and target_path NOT LIKE '%-%' and target_path NOT LIKE '%group%' and target_path NOT LIKE '%passwd%' and target_path NOT LIKE '%/opt/impulse%' and target_path NOT LIKE '%/etc/ufw%' and target_path NOT LIKE '%/etc/osquery/osquery.conf%';",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "files_and_folders",
    "enabled": 1,
    "attck": "T1222,T1070/004",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "ftp_process",
    "description": "FTP process",
    "query": "SELECT * FROM processes WHERE name = 'ftp'",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "T1105,TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "groups",
    "description": "Retrieves the list of groups.",
    "query": "SELECT * FROM groups;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "users_and_authentication",
    "enabled": 1,
    "attck": "T1136,T1078",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "hidden_directories",
    "description": "Lists hidden directories in relevant path.",
    "query": "SELECT fi.path, fi.filename, datetime(fi.btime, 'unixepoch', 'UTC') AS btime, datetime(fi.atime, 'unixepoch', 'UTC') AS atime, datetime(fi.ctime, 'unixepoch', 'UTC') AS ctime, datetime(fi.mtime, 'unixepoch', 'UTC') AS mtime FROM file fi WHERE ((fi.path LIKE '/home/%%/.%') OR (fi.path LIKE '/root/.%')) AND type='directory';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "hidden_files",
    "description": "Lists hidden files in relevant path.",
    "query": "SELECT hash.sha1, fi.path, fi.filename, datetime(fi.btime, 'unixepoch', 'UTC') AS btime, datetime(fi.atime, 'unixepoch', 'UTC') AS atime, datetime(fi.ctime, 'unixepoch', 'UTC') AS ctime, datetime(fi.mtime, 'unixepoch', 'UTC') AS mtime FROM hash JOIN file fi USING (path) WHERE ((fi.path LIKE '/home/%%/.%') OR (fi.path LIKE '/root/.%')) AND type='regular';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "homebrew_packages",
    "description": "Retrieves the list of brew packages installed in the target OSX system.",
    "query": "SELECT * FROM homebrew_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "darwin",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "hping3_installed",
    "description": "hping3 was installed",
    "query": "SELECT * FROM deb_packages where name = 'hping3';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "interface_addresses",
    "description": "Retrieves the list of network interfaces.",
    "query": "SELECT * FROM interface_addresses;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "network",
    "enabled": 1,
    "attck": "T1040",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "ip_forwarding",
    "description": "Retrieves the current status of IP/IPv6 forwarding. Helps you identify if a machine is being used as relay.",
    "query": "SELECT * FROM system_controls WHERE oid = '4.30.41.1' UNION SELECT * FROM system_controls WHERE oid = '4.2.0.1';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "iptables",
    "description": "Retrieves the current filters and chains per filter in the target system. Helps you verify firewall settings are as restrictive as you need. Identify unwanted firewall holes made by malware or humans",
    "query": "SELECT * FROM iptables;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "kernel_info",
    "description": "Retrieves information from the current kernel in the target system. Helps you identify out of date kernels or version drift across your infrastructure.",
    "query": "SELECT * FROM kernel_info;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "kernel_modules",
    "description": "Retrieves all the information for the current kernel modules in the target Linux system. Helps you identify malware that has a kernel module component.",
    "query": "SELECT * FROM kernel_modules;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1547/006",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "kernel_modules_and_extensions",
    "description": "Detect loading, unloading, and manipulating modules on Linux systems.",
    "query": "SELECT usr.username, sht.command, sht.history_file FROM shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid FROM users) AND (sht.command LIKE '%modprobe%' OR sht.command LIKE '%insmod%' OR sht.command  LIKE '%lsmod%' OR sht.command  LIKE '%rmmod%' OR sht.command LIKE '%modinfo%' OR sht.command LIKE '%linux-headers-$%'OR sht.command LIKE '%kernel-devel-$%');",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "last",
    "description": "Retrieves the list of the latest logins with PID, username and timestamp. Useful for intrusion detection and incident response. Verify assumptions of what accounts should be accessing what systems and identify machines accessed during a compromise.",
    "query": "SELECT * FROM last;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "users_and_authentication",
    "enabled": 1,
    "attck": "T1078",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "ld_preload_snapshot",
    "description": "Any processes that run with an LD_PRELOAD environment variable.",
    "query": "SELECT process_envs.pid, process_envs.key, process_envs.value, processes.name, processes.path, processes.cmdline, processes.cwd FROM process_envs JOIN processes USING (pid) WHERE KEY = 'LD_PRELOAD';",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 1,
    "platform": "linux",
    "category": "processes",
    "enabled": 1,
    "attck": "T1136,T1574/006",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "listening_ports",
    "description": "Retrieves all the listening ports in the target system. Detect if a listening port is not mapped to a known process. Find backdoors.",
    "query": "SELECT * FROM listening_ports;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "network",
    "enabled": 0,
    "attck": "T1029,T1011,T1041,T1048,T1020,T1071,T1219,T1505/003",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "logged_in_users",
    "description": "Retrieves the list of all the currently logged in users in the target system.",
    "query": "SELECT liu.*, p.name, p.cmdline, p.cwd, p.root FROM logged_in_users liu, processes p WHERE liu.pid = p.pid;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "memory_available_snapshot",
    "description": "Track memory usage.",
    "query": "SELECT printf('%.2f',((memory_total - memory_available) * 1.0)/1073741824) AS used_space_gb, printf('%.2f',(1.0 * memory_available / 1073741824)) AS space_left_gb, printf('%.2f',(1.0 * memory_total / 1073741824)) AS total_space_gb, printf('%.2f',(((memory_total - memory_available) * 1.0)/1073741824)/(1.0 * memory_total / 1073741824)) * 100 AS '%_used', printf('%.2f',(1.0 * memory_available / 1073741824)/(1.0 * memory_total / 1073741824)) * 100 AS '%_available' FROM memory_info;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 1,
    "platform": "linux",
    "category": "metrics",
    "enabled": 0,
    "attck": "T1496",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "mounts",
    "description": "Retrieves the current list of mounted drives in the target system.",
    "query": "SELECT * FROM mounts;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "nbtscan_installed",
    "description": "nbtscan was installed.",
    "query": "SELECT * FROM deb_packages where name = 'nbtscan';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "netcat_installed",
    "description": "Netcat was installed.",
    "query": "SELECT * FROM deb_packages where name = 'netcat';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "netcat_listener",
    "description": "Netcat listener.",
    "query": "SELECT * FROM processes WHERE name = 'nc' AND cmdline LIKE '%-l%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "T1049,TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "nmap_installed",
    "description": "Nmap was installed.",
    "query": "SELECT * FROM deb_packages where name = 'nmap';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "nmap_process",
    "description": "Nmap process.",
    "query": "SELECT * FROM processes WHERE name = 'nmap'",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "processes",
    "enabled": 1,
    "attck": "T1423,TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "npm_packages",
    "description": "Retrieves the list of NPM packages.",
    "query": "SELECT * FROM npm_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1059/006",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "open_files",
    "description": "Retrieves all the open files per process in the target system. Helps you identify processes accessing sensitive files they shouldn't.",
    "query": "SELECT DISTINCT pid, path FROM process_open_files WHERE path NOT LIKE '/private/var/folders%' AND path NOT LIKE '/System/Library/%' AND path NOT IN ('/dev/null', '/dev/urandom', '/dev/random');",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "open_sockets",
    "description": "Retrieves all the open sockets per process in the target system. Helps you identify malware via connections to known bad IP addresses as well as odd local or remote port bindings.",
    "query": "SELECT DISTINCT pid, family, protocol, local_address, local_port, remote_address, remote_port, path FROM process_open_sockets WHERE path <> '' OR remote_address <> '';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "openssh_server_installed",
    "description": "OpenSSH was installed.",
    "query": "SELECT * FROM deb_packages where name = 'openssh-server';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1021/004",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "openssl_exfiltration",
    "description": "OpenSSL exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'openssl' AND cmdline LIKE '%connect%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "os_version",
    "description": "Retrieves information from the Operative System where osquery is currently running. Helps you identify out of date operating systems or version drift across your infrastructure.",
    "query": "SELECT * FROM os_version;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "php_server",
    "description": "PHP server.",
    "query": "SELECT * FROM processes WHERE name = 'php' AND cmdline LIKE '%-S 0.0.0.0%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "portage_packages",
    "description": "Retrieves all the packages installed with portage from the target Linux system.",
    "query": "SELECT * FROM portage_packages;",
    "version": "2.0.0",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "process_env",
    "description": "Retrieves all the environment variables per process in the target system. Insight into the process data: where was it started from, was it preloaded...",
    "query": "SELECT * FROM process_envs;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "process_listening_port",
    "description": "Returns the listening ports list.",
    "query": "SELECT p.name, p.path, lp.port, lp.address, lp.protocol  FROM listening_ports lp LEFT JOIN processes p ON lp.pid = p.pid WHERE lp.port != 0 AND p.name != '';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 0,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "process_open_sockets",
    "description": "Returns the network connections from system processes.",
    "query": "SELECT DISTINCT p.name, p.path, pos.remote_address, pos.remote_port FROM process_open_sockets pos LEFT JOIN processes p ON pos.pid = p.pid WHERE pos.remote_port != 0 AND p.name != '';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 0,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "processes",
    "description": "Processes running on the host.",
    "query": "SELECT pid, name, path, cmdline FROM processes WHERE name NOT IN ('systemd', 'systemd-network', 'dbus-daemon', 'cron', 'networkd-dispat', 'VBoxService', 'kstrp', 'systemd-resolve', 'pickup', 'osqueryd', 'rsyslogd', 'nginx', 'mysqld', 'sshd', 'sudo', 'su', 'systemd-journal', 'vuls', 'accounts-daemon', 'acpi_thermal_pm', 'snapd', 'osqueryi','bash', 'polkitd', 'Suricata-Main', 'systemctl', 'systemd-tty-ask', 'sendmail', 'procmail', 'sendmail-msp', 'postgres', 'systemd-udevd', 'containerd-shim', 'Isolated Web Co', 'celery', 'docker') AND name NOT LIKE '%loop%' AND name NOT LIKE '%kworker%' AND name NOT LIKE '%scsi%' AND name NOT LIKE '%postgres:%' AND cmdline NOT LIKE '%:6379%' AND name NOT LIKE '%migration%' AND name NOT LIKE '%postgres: postgres%' AND name NOT LIKE '%watchdog%' AND name NOT LIKE '%cpuhp%' AND name NOT LIKE '%cpuhp%' AND name NOT LIKE '%ksoftirqd%' AND name NOT LIKE '%mysql%' AND name NOT LIKE '%kswapd%' AND name NOT LIKE '%postgres%' AND name NOT LIKE '%systemd-udevd%' AND name NOT LIKE '%sendmail%' AND cmdline NOT LIKE '%localhost:5020 --reload wsgi:app%' AND cmdline NOT LIKE '%127.0.0.1:5020%' AND cmdline NOT LIKE '%analytics_run.sh%' AND cmdline NOT LIKE '%PingStatusUpdate.py%' AND cmdline NOT LIKE '%ping_status_update.sh%' AND cmdline NOT LIKE '%full_status_update.sh%' AND cmdline NOT LIKE '%go-cve-dictionary%' AND cmdline NOT LIKE '%impulse/tasks_manager%' AND cmdline NOT LIKE '%FullStatusUpdate.py%' AND cmdline NOT LIKE '%build_status_report.sh%' AND cmdline NOT LIKE '%sendmail%' AND cmdline NOT LIKE '%main.bgtasks.general_tasks worker%' AND cmdline NOT LIKE '%impulse.conf%' AND cmdline NOT LIKE '%host-port 7543%' AND cmdline NOT LIKE '%/etc/init.d/sendmail%' AND cmdline NOT LIKE '%auxiliary_server/venv/bin/gunicorn%' AND cmdline NOT LIKE '%gunicorn_starter.sh%' AND cmdline NOT LIKE '%tasks_manager/cron_tasks/detections.sh%' AND cmdline NOT LIKE '%nids_flow_analysis.sh%' AND cmdline NOT LIKE '%/usr/lib/firefox-esr/firefox-esr%' AND cmdline NOT LIKE '%impulse-bgtasks%' AND cmdline NOT LIKE '%main.celery_app worker%' AND cmdline NOT LIKE '%/impulse/aux_server/aux-venv%' AND cmdline NOT LIKE '%sleep%' AND cmdline NOT LIKE '%0.0.0.0:5020%' AND cmdline NOT LIKE '%usr/bin/suricata-update%';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "processes",
    "enabled": 1,
    "attck": "T1057",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "processor_available_snapshot",
    "description": "Track processor usage.",
    "query": "SELECT printf(ROUND((CAST(SUM(system) AS FLOAT)/(SUM(idle)+SUM(system)+SUM(USER)))*100,2)) AS time_spent_on_system_workloads_pct, printf(ROUND((CAST(SUM(USER) AS FLOAT)/(SUM(idle)+SUM(system)+SUM(USER)))*100,2)) AS time_spent_on_user_workloads_pct, printf(ROUND((CAST(SUM(idle) AS FLOAT)/(SUM(idle)+SUM(system)+SUM(USER)))*100,2)) AS time_spent_idle_pct FROM cpu_time;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 1,
    "platform": "posix",
    "category": "metrics",
    "enabled": 0,
    "attck": "T1496",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "python_packages",
    "description": "Retrieves the list of Python packages.",
    "query": "SELECT * FROM python_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1059/006",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "python_server",
    "description": "Python server",
    "query": "SELECT * FROM processes WHERE name = 'python' OR name = 'python3' AND cmdline LIKE '%http.server%' OR cmdline LIKE '%SimpleHTTPServer%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "ramdisk",
    "description": "Retrieves all the ramdisk currently mounted in the target system. Helps you identify if an attacker is using temporary, memory storage to avoid touching disk for anti-forensics purposes.",
    "query": "SELECT * FROM block_devices WHERE type = 'Virtual Interface';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "registry_hives",
    "description": "Retrieves all of the Windows registry hives.",
    "query": "SELECT * FROM registry;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "windows",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "rpm_packages",
    "description": "Retrieves all the installed RPM packages in the target Linux system.",
    "query": "SELECT * FROM rpm_packages;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1072",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "ruby_server",
    "description": "Ruby server",
    "query": "SELECT * FROM processes WHERE name = 'ruby' AND cmdline LIKE '%httpd%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "scapy_installed",
    "description": "Scapy was installed",
    "query": "SELECT * FROM deb_packages where name = 'scapy';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1570",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "scheduled_tasks",
    "description": "Retrieves all the scheduled tasks in the target Windows system. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM scheduled_tasks;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "windows",
    "category": "processes",
    "enabled": 1,
    "attck": "T1053/003",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "scp_secure_copy",
    "description": "SCP Secure Copy.",
    "query": "SELECT * FROM processes WHERE name = 'scp'",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "T1105,TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "services",
    "description": "Lists all installed Windows services and their relevant data. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM services;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "windows",
    "category": "processes",
    "enabled": 1,
    "attck": "T1543/002",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "shell_check",
    "description": "Returns possible reverse shells on system processes.",
    "query": "SELECT DISTINCT(processes.pid),processes.parent,processes.name,processes.path,processes.cmdline,processes.cwd,processes.root,processes.uid,processes.gid,processes.start_time,process_open_sockets.remote_address,process_open_sockets.remote_port,(SELECT cmdline FROM processes AS parent_cmdline WHERE pid = processes.parent) AS parent_cmdline FROM processes JOIN process_open_sockets USING(pid) LEFT OUTER JOIN process_open_files ON processes.pid = process_open_files.pid WHERE (name = 'sh' OR name = 'bash') AND process_open_files.pid IS NULL;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 0,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "shell_history",
    "description": "Retrieves the command history, per user, by parsing the shell history files. Identify actions taken. Useful for compromised hosts.",
    "query": "SELECT * FROM users JOIN shell_history USING (uid);",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "users_and_authentication",
    "enabled": 1,
    "attck": "T1059/004",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "shell_history_root",
    "description": "Record shell history for root user. Identify actions taken. Useful for compromised hosts.",
    "query": "select * from shell_history;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "users_and_authentication",
    "enabled": 1,
    "attck": "T1059/004",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "socket_events",
    "description": "Socket events collected from the audit framework",
    "query": "SELECT action, auid, family, local_address, local_port, path, pid, remote_address, remote_port, success, time FROM socket_events WHERE success=1 AND path NOT IN ('/usr/bin/hostname') AND remote_address NOT IN ('127.0.0.1','127.0.0.53','', '0000:0000:0000:0000:0000:0000:0000:0001', '::1', '0000:0000:0000:0000:0000:ffff:7f00:0001', 'unknown', '0.0.0.0', '0000:0000:0000:0000:0000:0000:0000:0000', '0') AND remote_address NOT LIKE '%192.168%' AND remote_address NOT LIKE '%127.0.0%' AND remote_address NOT LIKE '%172.19.0.%' AND remote_address NOT LIKE '%10.16%' and remote_port != '0' and remote_port != '5432' and remote_port != '50051' and path NOT LIKE '%/bin/docker-proxy%' and path NOT LIKE '%/bin/postgres%' and path NOT LIKE '%/bin/redis-server%' and path NOT LIKE '%/usr/lib/firefox-esr/firefox-esr%' and path NOT LIKE '%/usr/libexec/sendmail/sendmail%' and path NOT LIKE '%/usr/local/bin/python3.9%';",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "network",
    "enabled": 0,
    "attck": "T1021,T1210",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "startup_items",
    "description": "Retrieves the list of systemd services. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM startup_items;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "processes",
    "enabled": 1,
    "attck": "T1543/002",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "sudoers",
    "description": "Linux sudoers information.",
    "query": "SELECT * FROM sudoers;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "sudoers_sha1",
    "description": "Check any bash reverse shell forwarded to the attacker.",
    "query": "SELECT hash.sha1, fi.path, fi.filename, datetime(fi.btime, 'unixepoch', 'UTC') AS btime, datetime(fi.atime, 'unixepoch', 'UTC') AS atime, datetime(fi.ctime, 'unixepoch', 'UTC') AS ctime, datetime(fi.mtime, 'unixepoch', 'UTC') AS mtime FROM hash JOIN file fi USING (path) WHERE (fi.path LIKE '/etc/sudoers') AND type='regular';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "sudoers_shell",
    "description": "Check any bash reverse shell forwarded to the attacker.",
    "query": "SELECT * FROM processes WHERE cmdline LIKE '/bin/bash -i >& /dev/tcp/%';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 0,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "suid_bin",
    "description": "Retrieves all the files in the target system that are setuid enabled. Detect backdoor binaries (attacker may drop a copy of /bin/sh). Find potential elevation points / vulnerabilities in the standard build.",
    "query": "SELECT * FROM suid_bin;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "processes",
    "enabled": 1,
    "attck": "T1548,T1548/001",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "system_running_processes",
    "description": "List running processes with CMDLINE not null.",
    "query": "SELECT pr.pid, pr.name, usr.username, pr.path, pr.cmdline FROM processes pr LEFT JOIN users usr ON pr.uid = usr.uid WHERE pr.cmdline != '';",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "systemd",
    "description": "Lists all installed Linux services and their relevant data. Helps you identify malware that uses this persistence mechanism to launch at a given interval.",
    "query": "SELECT * FROM systemd_units;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "processes",
    "enabled": 1,
    "attck": "T1543/002",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "tar_archive_created",
    "description": "Tar Archive Created",
    "query": "SELECT * FROM processes WHERE name = 'tar' AND cmdline LIKE '%-c%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "tcpdump_installed",
    "description": "Tcpdump was installed",
    "query": "SELECT * FROM deb_packages where name = 'tcpdump';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1040,T1570",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "usb_devices",
    "description": "Retrieves the current list of USB devices in the target system.",
    "query": "SELECT * FROM usb_devices;",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "posix",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "user_ssh_keys",
    "description": "Returns the private keys in the users ~/.ssh directory and whether or not they are encrypted.",
    "query": "SELECT * FROM users CROSS JOIN user_ssh_keys USING (uid);",
    "version": "1.4.5",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "users",
    "description": "Retrieves the list of local system users.",
    "query": "SELECT * FROM users;",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "users_and_authentication",
    "enabled": 1,
    "attck": "T1078,T1136/001",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "wget_exfiltration",
    "description": "Wget exfiltration.",
    "query": "SELECT * FROM processes WHERE name = 'wget' AND cmdline NOT LIKE '%--post-file=%' AND cmdline LIKE '%nids-profile-analysis/analyse-flows%' AND cmdline LIKE '%scan-installed-pkgs%' AND cmdline NOT LIKE '%agent-gateway/send/full-status-update%'; ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "wget_file_download",
    "description": "Wget file download.",
    "query": "SELECT * FROM processes WHERE name = 'wget' AND cmdline NOT LIKE '%agent-gateway/send/full-status-update%' AND cmdline NOT LIKE '%local-endpoint/%'",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "file_download",
    "enabled": 1,
    "attck": "T1105",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "whois_exfiltration",
    "description": "Whois exfiltration.",
    "query": "SELECT * FROM processes WHERE cmdline LIKE '%whois -h%' ",
    "version": "1.4.5",
    "interval": 30,
    "removed": 1,
    "snapshot": 0,
    "platform": "all",
    "category": "data_exfiltration",
    "enabled": 1,
    "attck": "TA0010",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "win_packages",
    "description": "Retrieves all the installed programs in the target Windows system.",
    "query": "SELECT * FROM programs;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "windows",
    "category": "modules_and_packages",
    "enabled": 1,
    "attck": "T1072",
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "win_firewall_rules",
    "description": "",
    "query": "SELECT * FROM windows_firewall_rules;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "windows",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "win_patches",
    "description": "Retrieves all the patches applied. Note: This does not include patches applied via MSI or downloaded from Windows Update (e.g. Service Packs).",
    "query": "SELECT * FROM patches;",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "windows",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "wireless_networks",
    "description": "Retrieves all the remembered wireless network that the target machine has connected to. Helps you identify connections to rogue access points.",
    "query": "SELECT ssid, network_name, security_type, last_connected, captive_portal, possibly_hidden, roaming, roaming_profile FROM wifi_networks;",
    "version": "1.6.0",
    "interval": 300,
    "removed": 1,
    "snapshot": 0,
    "platform": "darwin",
    "category": "other",
    "enabled": 1,
    "attck": null,
    "is_ioc": 0,
    "score": 0
  },
  {
    "name": "wireshark_installed",
    "description": "Wireshark was installed",
    "query": "SELECT * FROM deb_packages where name = 'wireshark';",
    "version": "1.4.5",
    "interval": 86400,
    "removed": 1,
    "snapshot": 0,
    "platform": "linux",
    "category": "installed_sec_tools",
    "enabled": 1,
    "attck": "T1046,T1040,T1570",
    "is_ioc": 0,
    "score": 0
  }
]